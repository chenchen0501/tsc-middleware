# TSC 打印机中文打印说明

## 🚀 快速开始

### 1. 运行测试程序

**推荐方式 - 使用批处理文件（自动设置编码）:**

```cmd
# 在命令提示符中运行
test.bat
```

或者

```powershell
# 在 PowerShell 中运行
.\test.ps1
```

### 2. 修改打印内容

编辑 `test_print.py` 文件中的配置：

```python
PRINT_CONFIGS = [
    {
        "name": "我的测试",
        "text": "这里写你要打印的中文",  # 修改这里
        "barcode": "BARCODE123",
        "qty": 1,
        "width": "100",
        "height": "90"
    },
]
```

## 🔧 中文乱码解决方案

### 问题1: 控制台显示乱码

**症状**: 运行 `python test_print.py` 时，控制台显示方框或问号

**解决方法**:

1. **方法A - 使用提供的批处理文件**（最简单）
   ```cmd
   test.bat
   ```

2. **方法B - 手动设置编码**
   
   在运行 Python 前先执行：
   ```cmd
   chcp 65001
   set PYTHONIOENCODING=utf-8
   python test_print.py
   ```

3. **方法C - PowerShell**
   ```powershell
   [Console]::OutputEncoding = [System.Text.Encoding]::UTF8
   $env:PYTHONIOENCODING = "utf-8"
   python test_print.py
   ```

### 问题2: 打印出来的标签上中文是乱码

**症状**: 控制台显示正常，但打印出来的标签上中文显示为问号或方框

**可能原因及解决方法**:

1. **打印机不支持该字体**
   
   在 `printer.py` 中修改字体代码：
   ```python
   # 原代码（第41行）
   p.send_command_utf8(f'TEXT 150,30,"5",0,1,1,"{text}"')
   
   # 尝试更换字体代码
   # 字体代码 "TSS24.BF2" 是TSC打印机常用的中文字体
   p.send_command_utf8(f'TEXT 150,30,"TSS24.BF2",0,1,1,"{text}"')
   ```

2. **需要下载中文字体到打印机**
   
   某些TSC打印机需要先下载中文字体文件：
   - 从TSC官网下载对应的中文字体文件（如 `TSS24.BF2`）
   - 使用TSC的BarTender软件或其他工具将字体下载到打印机

3. **使用内置字体**
   
   TSC打印机内置字体代码参考：
   - `"1"` - 8x12 点
   - `"2"` - 12x20 点  
   - `"3"` - 16x24 点
   - `"4"` - 24x32 点
   - `"5"` - 32x48 点（推荐用于中文）
   - `"TSS24.BF2"` - 24点中文字体
   - `"TSS32.BF2"` - 32点中文字体

## 📝 完整测试流程

1. **修改打印机IP**
   
   编辑 `test_print.py` 第17行：
   ```python
   PRINTER_IP = "192.168.1.100"  # 改成你的打印机IP
   ```

2. **测试连接**
   ```python
   from printer import test_connection
   print(test_connection("192.168.1.100"))  # 应该返回 True
   ```

3. **运行测试脚本**
   ```cmd
   test.bat
   ```

4. **选择测试项**
   ```
   请选择要执行的测试：
     1. 测试1 - 英文打印
     2. 测试2 - 中文打印
     3. 测试3 - 中英文混合
     4. 执行所有测试
     0. 退出
   
   请输入选项 (0-4): 2
   ```

## 🎯 最佳实践

1. **始终使用 UTF-8 编码保存文件**
   - 在编辑器中确保文件保存为 UTF-8 编码
   - VS Code: 右下角点击编码 → 选择 "UTF-8"

2. **使用提供的启动脚本**
   - `test.bat` 和 `test.ps1` 已经配置好所有编码设置
   - 避免直接运行 `python test_print.py`

3. **字体选择**
   - 纯英文/数字：使用内置字体 1-5
   - 中文内容：使用字体 "5" 或 "TSS24.BF2"
   - 混合内容：使用 "TSS24.BF2" 或 "TSS32.BF2"

4. **标签尺寸调整**
   - 中文字符较宽，建议适当增加标签宽度
   - 推荐尺寸：100mm x 90mm 或更大

## 🆘 常见问题

**Q: 为什么有些中文字符能显示，有些不能？**

A: 可能是打印机字体不完整。尝试更换字体或下载完整的中文字体到打印机。

**Q: 如何查看打印机支持哪些字体？**

A: 参考打印机说明书或使用TSC官方工具查询。大多数TSC打印机支持下载自定义字体。

**Q: 能否使用其他字体文件？**

A: 可以。需要先将 `.TTF` 字体转换为 TSC 支持的格式（`.BF2`），然后下载到打印机。

**Q: 打印速度慢？**

A: 中文字体文件较大，打印速度会比英文慢。可以在 `printer.py` 中调整 SPEED 参数（第36行）。

## 📞 技术支持

如果问题仍未解决：

1. 检查 `printer.py` 中的字体设置（第41行）
2. 确认打印机型号和固件版本
3. 查阅打印机手册中关于字体的说明
4. 联系TSC技术支持获取中文字体文件

